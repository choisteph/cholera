<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Duplicate and Missing Cases • cholera</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha256-916EbMg70RQy9LHiGkXzG8hSg9EdNy97GazNG/aiY1w=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha256-eZrrJcwDc/3uDhsdt61sL2oOBY362qM3lon1gyExkL0=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script><!-- sticky kit --><script src="https://cdnjs.cloudflare.com/ajax/libs/sticky-kit/1.1.3/sticky-kit.min.js" integrity="sha256-c4Rlo1ZozqTPE2RLuvbusY3+SU1pQaJC0TjuhygMipw=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Duplicate and Missing Cases">
<meta property="og:description" content="">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">cholera</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.5.9.9024</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/duplicate.missing.cases.html">Duplicate and Missing Cases</a>
    </li>
    <li>
      <a href="../articles/kernel.density.html">Kernel Density Plot</a>
    </li>
    <li>
      <a href="../articles/notes/duplicate.missing.cases.notes.html">* note on duplicate and missing cases</a>
    </li>
    <li>
      <a href="../articles/notes/euclidean.voronoi.html">* Euclidean v. Voronoi neighborhoods</a>
    </li>
    <li>
      <a href="../articles/notes/pump.neighborhoods.notes.html">* points v. polygons</a>
    </li>
    <li>
      <a href="../articles/notes/references.html">* References</a>
    </li>
    <li>
      <a href="../articles/notes/unstacking.bars.notes.html">* computing street addressess</a>
    </li>
    <li>
      <a href="../articles/pump.neighborhoods.html">Pump Neighborhoods</a>
    </li>
    <li>
      <a href="../articles/roads.html">Roads</a>
    </li>
    <li>
      <a href="../articles/tiles.polygons.html">deldirPolygons(): Tiles, Triangles and Polygons</a>
    </li>
    <li>
      <a href="../articles/time.series.html">Time Series</a>
    </li>
    <li>
      <a href="../articles/unstacking.bars.html">"Unstacking" Bars</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/lindbrook/cholera">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      
      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1>Duplicate and Missing Cases</h1>
                        <h4 class="author">lindbrook</h4>
            
            <h4 class="date">2019-01-04</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/lindbrook/cholera/blob/master/vignettes/duplicate.missing.cases.Rmd"><code>vignettes/duplicate.missing.cases.Rmd</code></a></small>
      <div class="hidden name"><code>duplicate.missing.cases.Rmd</code></div>

    </div>

    
    
<p>John Snow’s map of the 1854 cholera outbreak in London is a canonical example of data visualization:<a href="#fn1" class="footnoteRef" id="fnref1"><sup>1</sup></a></p>
<div class="figure">
<img src="../../../Data%20IV/cholera/vignettes/msu-snows-mapB.jpg">
</div>
<p>In 1992, Rusty Dodson and Waldo Tobler digitized the map. While the original data are no longer available,<a href="#fn2" class="footnoteRef" id="fnref2"><sup>2</sup></a> they are preserved in Michael Friendly’s ‘HistData’ package. These data are plotted below:</p>
<p><img src="duplicate.missing.cases_files/figure-html/unnamed-chunk-2-1.png" width="480" style="display: block; margin: auto;"></p>
<div id="data-problem" class="section level3">
<h3 class="hasAnchor">
<a href="#data-problem" class="anchor"></a>Data problem</h3>
<p>I would argue that there are two apparent coding errors in these data that stem from three misplaced cases.</p>
<p>While the data record 578 bars, only 575 of them have a unique x-y coordinate.<a href="#fn3" class="footnoteRef" id="fnref3"><sup>3</sup></a> Three pairs have identical coordinates: 1) 93 and 214; 2) 91 and 241; and 3) 209 and 429. Within the scheme of stacking bars to represent the fatality count, this cannot occur. Each bar should have a unique x-y coordinate. For this reason, duplicates are likely to be coding errors.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">duplicates &lt;-<span class="st"> </span>HistData<span class="op">::</span>Snow.deaths[(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/duplicated">duplicated</a></span>(HistData<span class="op">::</span>Snow.deaths[,
  <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="st">"x"</span>, <span class="st">"y"</span>)])), ]

duplicates.id &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/lapply">lapply</a></span>(duplicates<span class="op">$</span>x, <span class="cf">function</span>(i) {
  HistData<span class="op">::</span>Snow.deaths[HistData<span class="op">::</span>Snow.deaths<span class="op">$</span>x <span class="op">==</span><span class="st"> </span>i, <span class="st">"case"</span>]
})

HistData<span class="op">::</span>Snow.deaths[<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/unlist">unlist</a></span>(duplicates.id), ]
<span class="co">#&gt;     case        x        y</span>
<span class="co">#&gt; 93    93 12.84460 11.61027</span>
<span class="co">#&gt; 214  214 12.84460 11.61027</span>
<span class="co">#&gt; 91    91 12.65285 11.26382</span>
<span class="co">#&gt; 241  241 12.65285 11.26382</span>
<span class="co">#&gt; 209  209 12.68321 11.28437</span>
<span class="co">#&gt; 429  429 12.68321 11.28437</span></code></pre></div>
<p>Fortunately, a careful comparison of Snow’s map and the map generated by Dodson and Tobler’s data reveals that there are also three “missing” bars in the latter. An expedient “fix” would be to simply use the duplicate observations to fill in for the “missing” bars:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">fatalities &lt;-<span class="st"> </span>HistData<span class="op">::</span>Snow.deaths

fix &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/data.frame">data.frame</a></span>(<span class="dt">x =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="fl">12.56974</span>, <span class="fl">12.53617</span>, <span class="fl">12.33145</span>), <span class="dt">y =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="fl">11.51226</span>, <span class="fl">11.58107</span>, <span class="fl">14.80316</span>))

fatalities[<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="dv">91</span>, <span class="dv">93</span>, <span class="dv">209</span>), <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="st">"x"</span>, <span class="st">"y"</span>)] &lt;-<span class="st"> </span>fix</code></pre></div>
<p>This fixed data set is available as <code>fatalities</code> in this package and as <code>Snow.deaths2</code> in ‘HistData’ (&gt;= ver. 0.7-8). For those interested, detail about how I arrived at these values can be found in <code><a href="../reference/fixFatalities.html">fixFatalities()</a></code> and in the “Note on Duplicate and Missing Cases”, which is available <a href="https://github.com/lindbrook/cholera/blob/master/docs/duplicate.missing.cases.notes.md">online</a> in this package’s GitHub repository.</p>
</div>
<div id="notes" class="section level2">
<h2 class="hasAnchor">
<a href="#notes" class="anchor"></a>Notes</h2>
</div>
<div class="footnotes">
<hr>
<ol>
<li id="fn1"><p>The map was originally published in Snow’s 1855 book, “On The Mode Of Communication Of Cholera”, and was reprinted in John Snow et. al., 1936. <em>Snow on Cholera: Being a Reprint of Two Papers</em>. New York: The Common Wealth Fund. You can also find the map online (a high resolution version is available at <a href="http://www.ph.ucla.edu/epi/snow/highressnowmap.html" class="uri">http://www.ph.ucla.edu/epi/snow/highressnowmap.html</a>) and in many books, including Edward Tufte’s 1997 “Visual Explanations: Images and Quantities, Evidence and Narrative”.<a href="#fnref1">↩</a></p></li>
<li id="fn2"><p><a href="http://www.ncgia.ucsb.edu/pubs/snow/snow.html" class="uri">http://www.ncgia.ucsb.edu/pubs/snow/snow.html</a><a href="#fnref2">↩</a></p></li>
<li id="fn3"><p>There is a lack of consensus about the actual number of cases represented in Snow’s map. For what it’s worth, I manually recounted the data on Snow’s map and the result I got matches Dodson and Tobler’s.<a href="#fnref3">↩</a></p></li>
</ol>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li><a href="#notes">Notes</a></li>
      </ul>
</div>
      </div>

</div>


      <footer><div class="copyright">
  <p>Developed by lindbrook.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.3.0.</p>
</div>
      </footer>
</div>

  

  </body>
</html>
